---
title: 记录一次群讨论
date: 2021-05-10
categories:
 - tcp
tags:
 - 文章
---
- 三水同学：大佬们问个问题  跨域处理是在tcp连接之前是吧
- 三水同学：这个问题本身就有问题
- 三水同学：跨域处理是中间转发的
- 三水同学：你跟真正的后端都不存在连接了
- 三水同学：你跟真正的后端都不存在连接了
- 大魔王：跨域跟tcp有关系吗
- 三水同学：你只是在跟你本地的webpack交互 你跟他建立了连接。。
- 三水同学：webpack帮你做了中间层转发。。
- 三水同学：在一个就是 你是 http协议 tcp是http的上一层了 或者说下一层 
- 三水同学：这问题问的我不知道到底该怎么回答。。
- null：因为tcp不是建立客户端和服务器的联系吗 然后再发送http请求  所以就产生了这一个问题
- 大壮：跨域不是浏览器做的事情吗？浏览器获取到了response之后才知道是不是跨域
- 三水同学：跨域是浏览器的一层拦截机制 但是 是在后端返回你信息之后才告诉你的 
- 三水同学：你的请求可以到达后端 但是 浏览器并不信任你
- 三水同学：或者说 后端不信任你
- 三水同学：因此才有了后台设置 cors请求头来放开跨域这个处理方案
- null：那就是说其实tcp是已经建立了和服务端的连接 只不过在发送http请求的时候由于浏览器的同源策略限制 才产生的跨域的问题？
- 大壮：后端除了浏览器在什么地方不信任你？跨域不全是浏览器行为？
- 三水同学：是浏览器行为 但是 后端可以设置请求头来允许跨域
- null：同源策略造成的跨域只会作用于我们的http请求，对于传输层上的tcp协议是没有影响的是不
- 三水同学：也就是让它保持绝对信任
- 大壮：后端设置的是响应头，请求头是浏览器行为
- 大壮：设置了响应头之后，浏览器获取到了响应头的信息，知道这个可以跨域
- 大壮：然后放行，不产生跨域问题
- 三水同学：好的 谢谢老师
- null：所以说请求是都可以达到后端的 然后浏览器根据相应头来判断是否跨域？ 只针对CORS吗？
- null：我突然对我以前的理解产生了怀疑

<img src="https://webdyc.oss-cn-beijing.aliyuncs.com/blog/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210512105200.png" alt="dyc" title="dyc" class="zoom-custom-imgs">

<img src="https://webdyc.oss-cn-beijing.aliyuncs.com/blog/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210512105211.png" alt="dyc" title="dyc" class="zoom-custom-imgs">

- 三水同学：看到了吧 在跨域情况下 后端收到的是这个东西
- 三水同学：这个请求是怎么到后端的
- 三水同学：来个老师解释下 我孤陋寡闻 就不解释了
- null：我一会回去再看看同源策略这个
- 景行：非简单请求情况下，浏览器会先发一条options预检请求，如果后端allow-methods里没有options，就会炸掉，如果配置好了，再看allow-origin
- 景行：allow-origin没配，响应就会被浏览器拦掉，但是服务端是可以发出正常响应的，只是浏览器不让你看
- null：简单请求也是浏览器拦截了是不 
- null：拦截了响应
- 三水同学：options内部是携带了即将请求的信息的
- 三水同学：因此后端可以根据这个信息来告诉浏览器是否放行
- 三水同学：因此 这个信任行为 不仅仅是浏览器 而是 浏览器和后端的双方决策 只不过浏览器是决策的发起者和最终执行者 而后端只是告诉了浏览器是否放行
- 三水同学：但是 你不通过浏览器 就不会触发options这个试探行为
- 三水同学：所以 就不会存在这个双方决策的过程
<img src="https://webdyc.oss-cn-beijing.aliyuncs.com/blog/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210512105719.png" alt="dyc" title="dyc" class="zoom-custom-imgs">
- 三水同学：一般会使用中间件进行这样的操作
- 三水同学：老师您看对吗











